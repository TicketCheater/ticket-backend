# JWT 를 채택한 이유

## JWT?
- JWT(Json Web Token)는 웹 애플리케이션 간에 정보를 안전하게 전송하기 위한 인증 및 권한 부여 메커니즘이다.
- JWT 는 간단한 데이터 구조로 이루어져 있으며, JSON 객체로 표현된다.
- JWT 는 세 부분으로 구성된다.
  - 헤더(Header): 토큰의 유형 및 해싱 알고리즘 등의 메타데이터를 포함한다. Base64 로 인코딩된다.
  - 페이로드(Payload): 토큰에 담겨 있는 클레임(claim)들을 포함한다. 클레임은 사용자에 대한 정보나 다른 데이터(ex. 사용자 ID, 만료 시간)를 나타낸다. Base64 로 인코딩된다.
  - 서명(Signature): 토큰의 유효성을 확인하기 위한 서명이다. 서명은 헤더와 페이로드를 기반으로 생성된다.

## 주요 특징
- 간단함(Simplicity): JWT 는 간단한 데이터 구조를 가지고 있으며, JSON 객체로 이루어져 있어 이해하기 쉽다. 이는 개발자들이 쉽게 구현하고 사용할 수 있도록 도와준다.
- 자가 포함(Self-contained): JWT 는 정보를 자체적으로 포함하고 있기 때문에, 추가적인 DB 조회 없이도 토큰 자체에서 사용자 정보를 확인할 수 있다. 이는 분산된 시스템에서 유용하게 사용될 수 있다.
- 확장성(Scalability): JWT 를 사용하면 서버의 부하를 줄일 수 있다. 토큰에 필요한 정보를 포함하기 때문에, 서버에서 사용자 상태를 저장하고 관리하는 부담이 줄어든다.
- 유연성(Flexibility): JWT 는 클레임(claim) 기반으로 구성되어 있어, 사용자의 정보를 유연하게 포함할 수 있다. 필요한 만큼의 클레임을 추가하거나 수정하여 다양한 사용 사례에 적용할 수 있다.
- 보안(Security): JWT 는 서명을 통해 토큰의 무결성을 보장한다. 서버는 이 서명을 통해 토큰의 유효성을 확인할 수 있으며, 이는 데이터 위변조를 방지하는 데 도움이 된다. 또한, HTTPS 와 같은 보안 통신 프로토콜을 함께 사용함으로써 토큰의 안정성을 높일 수 있다.
- 분산 아키텍처(Distributed Architecture): JWT 를 사용하면 서비스 간에 토큰을 공유하여 인증을 수행할 수 있다. 이는 MSA 와 같이 분산된 환경에서 유용하다.
- 클라이언트 측 저장(Client-side Storage): JWT 는 클라이언트 측에 저장될 수 있으며, 서버에서 사용자의 상태를 유지할 필요가 없다. 이는 서버리스 아키텍처나 SPA(Single Page Application)와 같은 환경에서 특히 유용하다.
- 크로스 도메인(Cross-domain): JWT 는 CORS 와 함께 사용할 수 있어, 여러 도메인 간에 정보를 안전하게 교환할 수 있다.

## Session 방식을 채택하지 않은 이유
- 분산 아키텍처에서의 유연성: 세션 기반 인증은 사용자의 세션 정보를 저장하고 관리해야 한다. 이는 서버 간의 상태를 공유해야 하는 복잡성을 증가시킨다. 병목성을 야기할 수 있고, 확장성을 저하시킬 수 있다.
- 성능 향상: 메모리 사용량이 증가할 수 있고, DB 나 캐시 같은 외부 저장소에 대한 접근이 필요할 수 있다. 이로 인해 세션 관리에 따른 오버헤드가 발생할 수 있다.

## JWT 사용 시 주의점
- 토큰의 유효 기간 관리: 토큰의 유효 기간을 너무 짧게 설정하면 사용자 경험이 저하될 수 있고, 너무 길면 토큰 탈취 시 보안이 위협받을 수 있다. 적절한 유효 기간을 설정하고, 만료된 토큰에 대해 적절히 대응하는 것이 중요하다.
- 토큰의 안전한 전송: JWT 는 클라이언트와 서버 간에 전송될 때 안전한 방법으로 전송되어야 한다. HTTPS 와 같은 암호화된 통신 프로토콜을 사용하여 토큰이 도청되거나 변조되는 것을 방지해야 한다.
- 토큰의 서명 알고리즘 선택: JWT 는 서명을 통해 무결성을 보장한다. 따라서 서명 알고리즘을 선택할 때 충분한 강도의 알고리즘을 사용해야 한다.
- 중요 정보의 포함 여부: 토큰에는 민감한 정보(ex. 비밀번호)를 포함하지 않아야 한다.
- 토큰의 재사용 방지: JWT 를 한 번 사용한 후에는 재사용하지 않는 것이 좋다. 특히, 로그아웃 시에 해당 토큰을 무효화하고, 새로운 토큰을 발급하는 것이 좋다.

## Refresh Token 을 도입한 이유
- 보안을 위해 토큰의 유효 기간을 짧게 설정해야 하지만, 이는 사용자 경험의 저하로 이어질 수 있기 때문에 주기적으로 토큰을 갱신하는 Refresh Token 을 도입했다.

## Refresh Token 은 왜 Redis 에 보관해야 하는가
- 보안 강화: Refresh Token 이 탈취되거나 유출되면 보안 위협이 발생할 수 있다. 캐시에 저장하게 되면, 클라이언트 측에서 토큰을 안전하게 보관하고 유출되는 것을 방지할 수 있다. 또한, 캐시에 저장된 토큰은 특별한 접근 권한이 필요한 곳에만 접근 가능하도록 설정할 수 있어 보안을 더욱 강화할 수 있다.
- 성능 향상: 캐시는 데이터를 메모리에 저장하므로 데이터에 빠르게 접근할 수 있다. 따라서 토큰을 캐시에 저장하면, I/O 오버헤드를 줄일 수 있다. 또한, Refresh Token 은 주기적으로 삭제되어야 하기 때문에 DB 보다는 캐시에 보관하는 것이 유리하다.
- 확장성: 여러 서버 간에 토큰을 공유하고 사용할 수 있다. 이는 분산 환경에서의 확장성을 높이고, 로드 밸런싱을 수행하는 데 도움이 된다.
